---
title: "Lista_3"
author: "Olga Foriasz"
date: "2025-10-15"
output:
  pdf_document: default
  html_document: default
header-includes:
- \usepackage[OT4]{polski}
- \usepackage[utf8]{inputenc}
- \usepackage{graphicx}
- \usepackage{float}
subtitle: Analiza przeżycia
fontsize: 11pt
---

# LISTA 4

## Zadanie 1 - Funkcja ilorazu wiarygodności

Zadanie zaczynamy od wygenerowania danych cenzurowanych I-go typu, które są realizacjami zmiennych losowych z rozkładu wykładniczego.

```{r, warning=FALSE}
generowanie_1 <- function(n,lambda){
  x <- rexp(n,lambda)
  x <- sort(x)
  t0 <- mean(x)
  delta <- numeric(n)
  delta[x<=t0]=1
  x[x>t0]=t0
  dane <- data.frame(x,delta)
  names(dane)<-c("czas","dane")
  return(dane)
}

generowanie_1(10,1/2)
```

Następnie piszemy funkcję wyliczającą funkcję wiarygodności:

```{r, warning=FALSE}

L <- function(x, t0, r, theta) {
  n <- length(x$czas)
  return (factorial(n) / factorial(n - r) * theta^r *
           exp(-theta * (sum(x$czas[1:r]) + t0 * (n - r))))
}


```

Korzystając z wcześniejszych funckji deklarujemy następną, w której wartością zwracaną będzie wartość poziomu krytycznego w teście ilorazu wiarygodności do testowania hipotez dwustronnych (type="two.sided"), jednostronnych prawostronnie (type="greater"), jednostronnych lewostronnie (type="less"):

```{r, warning=FALSE}
IW <- function(x,t0,r,theta0,type){
  n <- length(x$czas)
  T1 <- sum(x$czas[1:r])+t0*(n-r)
  t <- r/T1
  mianownik <- L(x,t0, r, t)
  if(type=="two.sided"){
    licznik = L(x,t0, r, theta0)
  }
  if(type=="greater"){
    if(mianownik <= theta0){
      licznik=mianownik
    }else{licznik=L(x,t0, r, theta0)}
  }
  if(type=="less"){
    if(mianownik>theta0){
      licznik=mianownik
    }else{licznik=L(x,t0, r, theta0)}
  }
  lambda = licznik/mianownik
  G=-2*log(lambda)
  return(1-pchisq(G,1))
}
```

## Zadanie 3

```{r, warning=FALSE, echo=FALSE}
## dane z zad.3 listy 2
#R=10
#n=20
t0=1
delta=numeric(n)
grupa_A <- numeric(n)
grupa_B <- numeric(n)

grupa_A[1:10] <- c(0.03345514, 0.08656403, 0.08799947, 0.24385821, 0.27755032,
0.40787247, 0.58825664, 0.64125620, 0.90679161, 0.94222208)

grupa_B[1:10] <- c(0.03788958, 0.12207257, 0.20319983, 0.24474299, 0.30492413,
0.34224462, 0.42950144, 0.44484582, 0.63805066, 0.69119721)

## cenzurowanie I-go typu

grupa_A[11:20] <- t0
grupa_B[11:20] <- t0

delta_A <- c(rep(1, 10), rep(0, 10))
delta_B <- c(rep(1, 10), rep(0, 10))

dane_A <- data.frame(czas = grupa_A, delta = delta_A)
dane_B <- data.frame(czas = grupa_B, delta = delta_B)
```

```{r}
IW(dane_A,1,10,1,"two.sided")
IW(dane_B,1,10,1,"two.sided")
```



