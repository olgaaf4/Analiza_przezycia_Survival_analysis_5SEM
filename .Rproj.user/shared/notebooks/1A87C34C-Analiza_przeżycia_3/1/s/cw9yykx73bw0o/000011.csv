"0","library(knitr)"
"0",""
"0","typ_I <- function(t0,theta,n){"
"0","  X<-numeric(n)"
"0","  delta <-numeric(n)"
"0","  check <- 0"
"0","  "
"0","  while (check == 0){"
"0","    X<-numeric(n)"
"0","    delta <-numeric(n)"
"0","    X=rexp(n, theta)"
"0","    X <- sort(X)"
"0","    for(i in 1:n){"
"0","      if(X[i]>t0){"
"0","        X[i] <- t0"
"0","        delta[i] <- 0"
"0","        check <- 1"
"0","      }else{delta[i]<-1}}"
"0","  }"
"0","  return(data.frame(X = X, delta = delta))"
"0","  X <- sort(X)"
"0","}"
"0","symulacja <- function(theta,n,t0,M){"
"0","  est1 <- numeric(M)"
"0","  est2 <- numeric(M)"
"0","  for (i in (1:M)){"
"0","    dane <- typ_I(t0,theta,n)"
"0","    R <- sum(dane$delta)"
"0","    T1 <- sum(dane$X)"
"0","    est1[i] <- R/T1"
"0","    est2[i] <- -log(1-R/n)/t0"
"0","  }"
"0","  bias1 <- est1-theta"
"0","  bias2 <- est2-theta"
"0","  mse1 <- bias1^2"
"0","  mse2 <- bias2^2"
"0","  bias_c1 <- mean(bias1)"
"0","  bias_c2 <- mean(bias2)"
"0","  mse_c1 <- mean(mse1)"
"0","  mse_c2 <- mean(mse2)"
"0","  return(c(bias_c1, bias_c2, mse_c1, mse_c2))"
"0","}"
"0","#symulacja(1,10,1,10000)"
"0",""
"0",""
"0","n_list <- c(10,30)"
"0","t0_list <- c(0.5,1,2)"
"0","wyniki <- list(6)"
"0","i <- 1"
"0","for (n in n_list){"
"0","  for (t0 in t0_list){"
"0","    wyniki[[i]] <- symulacja(1,n,t0,10000)"
"0","    i = i+1"
"0","  }"
"0","}"
"0",""
"0","wyniki_df <- data.frame("
"0","  n = rep(n_list, each = length(t0_list)),"
"0","  t0 = rep(t0_list, times = length(n_list)),"
"0","  Bias_Est1 = round(sapply(wyniki, function(x) x[1]), 4),"
"0","  Bias_Est2 = round(sapply(wyniki, function(x) x[2]), 4),"
"0","  MSE_Est1 = round(sapply(wyniki, function(x) x[3]), 4),"
"0","  MSE_Est2 = round(sapply(wyniki, function(x) x[4]), 4)"
"0",")"
"0",""
"0","kable(wyniki_df, "
"0","      booktabs = TRUE,"
"0","      col.names = c("
"0","        ""n"", "
"0","        ""$t_0$"", "
"0","        ""Bias $\\hat{\\vartheta}$"", "
"0","        ""Bias $\\tilde{\\vartheta}$"", "
"0","        ""MSE $\\hat{\\vartheta}$"", "
"0","        ""MSE $\\tilde{\\vartheta}$""),"
"0","      caption = ""Wyniki symulacji dla różnych wartości n i t0"")"
