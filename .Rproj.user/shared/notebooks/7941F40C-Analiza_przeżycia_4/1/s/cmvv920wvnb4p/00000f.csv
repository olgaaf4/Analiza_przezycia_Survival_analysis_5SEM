"0","IW <- function(x,t0,r,theta0,type){"
"0","  n <- length(x$czas)"
"0","  T1 <- sum(x$czas[1:r])+t0*(n-r)"
"0","  t <- r/T1"
"0","  mianownik <- L(x,t0, r, t)"
"0","  if(type==""two.sided""){"
"0","    licznik = L(x,t0, r, theta0)"
"0","  }"
"0","  if(type==""greater""){"
"0","    if(mianownik <= theta0){"
"0","      licznik=mianownik"
"0","    }else{licznik=L(x,t0, r, theta0)}"
"0","  }"
"0","  if(type==""less""){"
"0","    if(mianownik>theta0){"
"0","      licznik=mianownik"
"0","    }else{licznik=L(x,t0, r, theta0)}"
"0","  }"
"0","  lambda = licznik/mianownik"
"0","  G=-2*log(lambda)"
"0","  return(1-pchisq(G,1))"
"0","}"
