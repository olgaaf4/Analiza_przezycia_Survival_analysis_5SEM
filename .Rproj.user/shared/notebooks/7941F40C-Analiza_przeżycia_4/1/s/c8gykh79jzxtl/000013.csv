"0","set.seed(666)"
"0","library(ggplot2)"
"0","typ_I <- function(t0,theta,n){"
"0","  X<-numeric(n)"
"0","  delta <-numeric(n)"
"0","  check <- 0"
"0","  "
"0","  while (check == 0){"
"0","    X<-numeric(n)"
"0","    delta <-numeric(n)"
"0","    X=rexp(n, theta)"
"0","    X <- sort(X)"
"0","    for(i in 1:n){"
"0","      if(X[i]>t0){"
"0","        X[i] <- t0"
"0","        delta[i] <- 0"
"0","        check <- 1"
"0","      }else{delta[i]<-1}}"
"0","  }"
"0","  czas <- sort(X)"
"0","  return(data.frame(czas = czas, delta = delta))"
"0","}"
"0","symulacja_moc <- function(theta,theta0,n,t0,alpha = 0.05,M=1000){"
"0","  count <- 0 "
"0","  for (i in (1:M)){"
"0","    x <- typ_I(t0,theta,n)"
"0","    r <- sum(x$delta)"
"0","    pv <- IW(x,t0,r,theta0,""two.sided"")"
"0","    if (pv<= alpha){"
"0","      count = count +1"
"0","    }"
"0","  }"
"0","  return(count/M)"
"0","}"
"0","theta0 <- 3 "
"0","theta_list <- c(0.5,1,1.5,2,2.5,3,3.5,4,4.5,5,5.5)"
"0","n20 <- numeric(length(theta_list))"
"0","n50 <- numeric(length(theta_list))"
"0","for (i in 1:length(theta_list)){"
"0","  n20[i] <- symulacja_moc(theta_list[i],theta0,20,0.5)"
"0","  n50[i] <- symulacja_moc(theta_list[i],theta0,50,0.5)"
"0","}"
"0","  "
"0",""
"0","df <- data.frame("
"0","  theta = rep(theta_list, 2),"
"0","  moc = c(n20, n50),"
"0","  n = factor(rep(c(20, 50), each=length(theta_list)))"
"0",")"
"0",""
"0","ggplot(df, aes(x=theta, y=moc, color=n, shape=n)) +"
"0","  geom_line(linewidth=1) +"
"0","  geom_point(size=3) +"
"0","  geom_hline(yintercept=0.05, linetype=""dashed"", color=""gray40"") +"
"0","  geom_vline(xintercept=theta0, linetype=""dashed"", color=""gray40"") +"
"0","  annotate(""text"", x=max(theta_list)-0.3, y=0.1, label='alpha=0.05',"
"0","           color=""gray30"", size=4, hjust=1) +"
"0","  annotate(""text"", x=theta0+0.4, y=0.9, label='theta_0 = 3',"
"0","           color=""gray30"", size=4, angle=90, vjust=-0.5) +"
"0","  scale_color_manual(values=c(""blue"", ""red"")) +"
"0","  labs(title=""Krzywe mocy testu ilorazu wiarygodności"","
"0","       x='theta', y=""Moc testu"","
"0","       color=""Wielkość próby"", shape=""Wielkość próby"") +"
"0","  theme_minimal(base_size=14)"
