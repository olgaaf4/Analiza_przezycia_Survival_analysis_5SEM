---
title: "Lista_3"
author: "Olga Foriasz"
date: "2025-10-15"
output:
  pdf_document: default
  html_document: default
header-includes:
- \usepackage[OT4]{polski}
- \usepackage[utf8]{inputenc}
- \usepackage{graphicx}
- \usepackage{float}
subtitle: Analiza przeżycia
fontsize: 11pt
---
# LISTA 3

## Zadanie 1a - Oszacowania największej wiarygodności

Dane bierzeny z zadania 3 z litsy 2. Wyznaczymy oszacowania największej wiarogodności średniego czasu do remisji choroby dla pacjentów leczonych lekiem A oraz pacjentów leczonych lekiem B. 

```{r,echo=FALSE, warning=FALSE}
## dane z zad.3 listy 2
R=10
n=20
t0=1
delta=numeric(n)
grupa_A <- numeric(n)
grupa_B <- numeric(n)

grupa_A[1:10] <- c(0.03345514, 0.08656403, 0.08799947, 0.24385821, 0.27755032,
0.40787247, 0.58825664, 0.64125620, 0.90679161, 0.94222208)

grupa_B[1:10] <- c(0.03788958, 0.12207257, 0.20319983, 0.24474299, 0.30492413,
0.34224462, 0.42950144, 0.44484582, 0.63805066, 0.69119721)

## cenzurowanie I-go typu

grupa_A[11:20] <- t0
grupa_B[11:20] <- t0

delta_A <- c(rep(1, 10), rep(0, 10))
delta_B <- c(rep(1, 10), rep(0, 10))

dane_A <- data.frame(czas = grupa_A, delta = delta_A)
dane_B <- data.frame(czas = grupa_B, delta = delta_B)
```

```{r}
T_a = sum(grupa_A[1:10]) + t0*(n-R)
T_b = sum(grupa_B[1:10]) + t0*(n-R) 

theta_a <- R/T_a
theta_b <- R/T_b
```

Średni czas do remisji dla leku A wynosi: `r theta_a`, natomiast dla leku B: `r theta_b`


## Zadanie 1b - Realizacje przedziału ufności

Wyznaczamy realizację przedziału ufności na poziomie 1-$\alpha$ dla średniego czasu do remisji choroby osobno dla pacjentów leczonych lekiem A oraz lekiem B (dane z listy 2. z zadania 3.) Zakładamy, że są to zmienne z rozkładu wykładniczego. Za $\alpha$ przyjmujemy kolejno $\alpha$=0.05 oraz $\alpha$=0.01.



```{r, echo=TRUE, warning=FALSE}
library(binom)

## dla alfy = 0.05
alfa=0.05
T.L <- binom.confint(R,n,conf.level=1-alfa, methods="exact")$lower
T.U <- binom.confint(R,n,conf.level=1-alfa, methods = "exact")$upper

TL1= (-log(1-T.L))/t0
TU1= (-log(1-T.U))/t0

TL1 = round(TL1,2)
TU1 = round(TU1,2)
## dla alfy = 0.01
alfa=0.01
T.L <- binom.confint(R,n,conf.level=1-alfa, methods="exact")$lower
T.U <- binom.confint(R,n,conf.level=1-alfa, methods = "exact")$upper

TL2= (-log(1-T.L))/t0
TU2= (-log(1-T.U))/t0

TL2 = round(TL2,2)
TU2 = round(TU2,2)
```
Realizacją przedziału ufności dla $\alpha$ = 0.05 jest przedział [$T_L, T_U$] =[`r TL1`, `r TU1`], natomiast dla $\alpha$ = 0.01 przedział [$T_L, T_U$] =[`r TL2`, `r TU2`]

## Zadanie 2 - Oszacowania największej wiarygodności i realizacja przedziału ufności dla danych z listy 2. zad.3

```{r,echo=FALSE, warning=FALSE}
##dane cenzurowane II-go typu
R=10
m=10
n=20
delta=numeric(n)
grupa_A <- numeric(n)
grupa_B <- numeric(n)

grupa_A[1:10] <- c(0.03345514, 0.08656403, 0.08799947, 0.24385821, 0.27755032,
0.40787247, 0.58825664, 0.64125620, 0.90679161, 0.94222208)

grupa_B[1:10] <- c(0.03788958, 0.12207257, 0.20319983, 0.24474299, 0.30492413,
0.34224462, 0.42950144, 0.44484582, 0.63805066, 0.69119721)

grupa_A[11:20] <- grupa_A[m]
grupa_B[11:20] <- grupa_B[m]

delta_A <- c(rep(1, 10), rep(0, 10))
delta_B <- c(rep(1, 10), rep(0, 10))

dane_A <- data.frame(czas = grupa_A, delta = delta_A)
dane_B <- data.frame(czas = grupa_B, delta = delta_B)
```

Przyjmujemy, że obserwacje czasu do remisji choroby były prowadzone do
momentu, w którym u dziesięciu pacjentów zostanie ona zaobserwowana. Dla takich danych wyznaczamy najpierw oszacowania największej wiarygodności średniego czasu do remisji choroby dla pacjentów leczonych lekiem A oraz pacjentów leczonych lekiem B.

```{r,echo=TRUE, warning=FALSE}
m=10
n=20
theta_a <- round(m/(sum(grupa_A[1:m])+(n-m)*grupa_A[m]),2)
theta_b <- round(m/(sum(grupa_B[1:m])+(n-m)*grupa_B[m]),2)
```   

Zatem z wyliczeń wynika, że oszacowania największej wiarygodności średniego czasu do remisji w grupie A wynoszą: `r theta_a`  a w grupie B: `r theta_b`.

Następnie dla danych wyznaczamy realizację przedziału ufności na poziomie 1-$\alpha$, dla odpowiednio dwóch wartości $\alpha$: 0.05 i 0.01. 

```{r,echo=TRUE, warning=FALSE}
m=10
n=20
Ta<-sum(grupa_A[1:m])+(n-m)*grupa_A[m]
Tb<-sum(grupa_B[1:m])+(n-m)*grupa_B[m]
## dla alfy = 0.05
alfa=0.05
qm_a1 = qgamma(alfa/2,m,rate=m)
TLa <- round((m*qm_a1)/Ta,2)
qm_a2 = qgamma((1-alfa/2),m,rate=m)
TUa <-round((m*qm_a2)/Ta,2)

qm_b1 = qgamma(alfa/2,m,rate=m)
TLb <- round((m*qm_b1)/Tb,2)
qm_b2 = qgamma((1-alfa/2),m,rate=m)
TUb <-round((m*qm_b2)/Tb,2)
```
Dla $\alpha$=0.05 realizacjami przedziałów ufności dla grupy A jest przedział [`r TLa`, `r TUa`] a dla grupy B: [`r TLb`, `r TUb`].

Następnie wyznaczamy realizację przedziału ufności dla $\alpha$=0.01:
```{r,echo=TRUE, warning=FALSE}
m=10
n=20
## dla alfy = 0.01
alfa=0.01
qm_a1 = qgamma(alfa/2,m,m)
TLa <- round((m*qm_a1)/Ta,2)
qm_a2 = qgamma((1-alfa/2),m,m)
TUa <-round((m*qm_a2)/Ta,2)

qm_b1 = qgamma(alfa/2,m,m)
TLb <- round((m*qm_a1)/Tb,2)
qm_b2 = qgamma((1-alfa/2),m,m)
TUb <- round((m*qm_b2)/Tb,2)
```  

Stąd otrzymujemy, że realizacjami przedziałów ufności dla grupy A jest przedział [`r TLa`, `r TUa`] a dla grupy B: [`r TLb`, `r TUb`].

# Zadanie 3 - porównanie estymatorów
